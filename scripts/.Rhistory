setwd("~/git/2025_g34p/scripts")
# libraries --------------------------------------------------------------------
library(tidyverse)
library(ggplot2)
library(dplyr)
library(stringr)
## phenology data
meta_pheno <- read.csv("../data/phenology/form-1__g34p-phenology.csv")
data_pheno <- read.csv("../data/phenology/branch-1__phenology.csv")
## plant and block information
meta_plant <- read.csv()
## plant and block information
meta_plant <- read.csv("../data_meta/plant_ids.csv")
## creating single id column
data <- data_pheno_full %>%
mutate(
ID = case_when(
X5_id_scan == "" ~ as.character(X6_id_number),
TRUE ~ str_extract(X5_id_scan, "\\d+$")
),
ID = as.numeric(ID)
)
data_pheno_full <- left_join(data_pheno, data_pheno_meta,
by = c('ec5_branch_owner_uuid' = 'ec5_uuid'))
## merging meta data with data
data_pheno_full <- left_join(data_pheno, meta_pheno,
by = c('ec5_branch_owner_uuid' = 'ec5_uuid'))
## creating single id column
data <- data_pheno_full %>%
mutate(
ID = case_when(
X5_id_scan == "" ~ as.character(X6_id_number),
TRUE ~ str_extract(X5_id_scan, "\\d+$")
),
ID = as.numeric(ID)
)
colnames(meta_plant)
unique(meta_plant$individual)
## phenology data
meta_pheno <- read.csv("../data/phenology/form-1__g34p-phenology.csv")
data_pheno <- read.csv("../data/phenology/branch-1__phenology.csv")
## plant and block information
meta_plant <- read.csv("../data_meta/plant_ids.csv")
## merging meta data with data
data_pheno_full <- left_join(data_pheno, meta_pheno,
by = c('ec5_branch_owner_uuid' = 'ec5_uuid'))
## creating single id column
data <- data_pheno_full %>%
mutate(
id = case_when(
X5_id_scan == "" ~ as.character(X6_id_number),
TRUE ~ str_extract(X5_id_scan, "\\d+$")
),
ID = as.numeric(ID)
)
## creating single id column
data <- data_pheno_full %>%
mutate(
id = case_when(
X5_id_scan == "" ~ as.character(X6_id_number),
TRUE ~ str_extract(X5_id_scan, "\\d+$")
),
id = as.numeric(id)
)
## adding plant and block information
data_pheno_full <- left_join(data_pheno_full, meta_plant,
by = c('id' = 'individual'))
colnames(data_pheno_full)
## phenology data
meta_pheno <- read.csv("../data/phenology/form-1__g34p-phenology.csv")
data_pheno <- read.csv("../data/phenology/branch-1__phenology.csv")
## plant and block information
meta_plant <- read.csv("../data_meta/plant_ids.csv")
## merging meta data with data
data_pheno_full <- left_join(data_pheno, meta_pheno,
by = c('ec5_branch_owner_uuid' = 'ec5_uuid'))
## creating single id column
data_pheno_full <- data_pheno_full %>%
mutate(
id = case_when(
X5_id_scan == "" ~ as.character(X6_id_number),
TRUE ~ str_extract(X5_id_scan, "\\d+$")
),
id = as.numeric(id)
)
## adding plant and block information
data_pheno_full <- left_join(data_pheno_full, meta_plant,
by = c('id' = 'individual'))
View(data_pheno_full)
View(data_pheno_full)
unique(data_pheno_full$phosphorous_p1.p4)
ggplot(data_pheno_full, aes (phosphorous_p1.p4, X7_leaf_count))
ggplot(data_pheno_full, aes (phosphorous_p1.p4, X7_leaf_count)) +
geom_boxplot()
ggplot(data_pheno_full, aes (phosphorous_p1.p4, X7_leaf_count, color = shade_00s_70s)) +
geom_boxplot()
View(data_pheno)
sum(is.na(data_pheno_full$id))
ggplot(data_pheno_full, aes (phosphorous_p1.p4, X7_leaf_count,
color = shade_00s_70s)) +
geom_boxplot() +
facet_wrap( ~ shade_00s_70s)
ggplot(data_pheno_full, aes (phosphorous_p1.p4, X7_leaf_count,
color = shade_00s_70s)) +
geom_boxplot() +
facet_grid( ~ shade_00s_70s)
data_pheno_full <- na.omit(data_pheno_full$id)
## phenology data
meta_pheno <- read.csv("../data/phenology/form-1__g34p-phenology.csv")
data_pheno <- read.csv("../data/phenology/branch-1__phenology.csv")
## plant and block information
meta_plant <- read.csv("../data_meta/plant_ids.csv")
# cleaning ---------------------------------------------------------------------
## merging meta data with data
data_pheno_full <- left_join(data_pheno, meta_pheno,
by = c('ec5_branch_owner_uuid' = 'ec5_uuid'))
## creating single id column
data_pheno_full <- data_pheno_full %>%
mutate(
id = case_when(
X5_id_scan == "" ~ as.character(X6_id_number),
TRUE ~ str_extract(X5_id_scan, "\\d+$")
),
id = as.numeric(id)
)
## adding plant and block information
data_pheno_full <- left_join(data_pheno_full, meta_plant,
by = c('id' = 'individual'))
View(data_pheno_full)
data_pheno_full_test <- na.omit(data_pheno_full)
data_pheno_full_test <- data_pheno_full %>%
drop_na('id')
unique(data_pheno_full_test$id)
sum(is.na(data_pheno_full_test$id))
## removing NA value form id, removes 1 row, which was just a note.
data_pheno_full <- data_pheno_full %>%
drop_na('id')
unique(data_pheno_full$shade_00s_70s)
ggplot(data_pheno_full, aes (phosphorous_p1.p4, X7_leaf_count,
color = shade_00s_70s)) +
geom_boxplot() +
facet_grid( ~ shade_00s_70s)
colnames(data_pheno_full)
summary_data <- data_pheno_full %>%
group_by(phosphorous_p1.p4, X1_date) %>%
summarise(mean_leaf = mean(X7_leaf_count),
se_leaf = sd(X7_leaf_count)/sqrt(n()), .groups = "drop")
ggplot(summary_data, aes(x = X1_date, y = mean_leaf, color = as.factor(phosphorous_p1.p4), group = phosphorous_p1.p4)) +
geom_line(size = 1.2) +
geom_point(size = 3) +
geom_errorbar(aes(ymin = mean_leaf - se_leaf, ymax = mean_leaf + se_leaf), width = 0.2) +
labs(x = "Week", y = "Mean leaf number", color = "Fertilizer") +
theme_minimal()
ggplot(summary_data, aes(x = X1_date, y = mean_leaf, color = as.factor(phosphorous_p1.p4), group = phosphorous_p1.p4)) +
geom_line(size = 1.2) +
geom_point(size = 3) +
geom_errorbar(aes(ymin = mean_leaf - se_leaf, ymax = mean_leaf + se_leaf), width = 0.2) +
facet_grid(~ shade_00s_70s) +
labs(x = "Week", y = "Mean leaf number", color = "Fertilizer") +
theme_minimal()
ggplot(summary_data, aes(x = X1_date, y = mean_leaf, color = as.factor(phosphorous_p1.p4), group = phosphorous_p1.p4)) +
geom_line(size = 1.2) +
geom_point(size = 3) +
geom_errorbar(aes(ymin = mean_leaf - se_leaf, ymax = mean_leaf + se_leaf), width = 0.2) +
facet_grid(~ shade_00s_70s) +
labs(x = "Week", y = "Mean leaf number", color = "Fertilizer") +
theme_minimal()
View(summary_data)
ggplot(summary_data, aes(x = X1_date, y = mean_leaf, color = as.factor(phosphorous_p1.p4), group = phosphorous_p1.p4)) +
geom_line(size = 1.2) +
geom_point(size = 3) +
geom_errorbar(aes(ymin = mean_leaf - se_leaf, ymax = mean_leaf + se_leaf), width = 0.2) +
facet_grid(~ shade_00s_70s) +
labs(x = "Week", y = "Mean leaf number", color = "Fertilizer") +
theme_minimal()
ggplot(your_data, aes(x = as.factor(X1_date), y = X7_leaf_count, fill = as.factor(phosphorous_p1.p4))) +
geom_boxplot(position = position_dodge(0.8)) +
labs(x = "Week", y = "Leaf number", fill = "Fertilizer") +
theme_minimal()
ggplot(data_pheno_full, aes(x = as.factor(X1_date), y = X7_leaf_count, fill = as.factor(phosphorous_p1.p4))) +
geom_boxplot(position = position_dodge(0.8)) +
labs(x = "Week", y = "Leaf number", fill = "Fertilizer") +
theme_minimal()
colnames(data_pheno_full)
summary_data <- data_pheno_full %>%
group_by(phosphorous_p1.p4, X1_date, shade_00s_70s) %>%
summarise(mean_leaf = mean(X7_leaf_count),
se_leaf = sd(X7_leaf_count)/sqrt(n()), .groups = "drop")
View(summary_data)
## summarizing data
summary_data <- data_pheno_full %>%
filter(!is.na(X7_leaf_count), X7_leaf_count > 0) %>%
group_by(phosphorous_p1.p4, X1_date, shade_00s_70s) %>%
summarise(mean_leaf = mean(X7_leaf_count),
se_leaf = sd(X7_leaf_count)/sqrt(n()), .groups = "drop")
View(summary_data)
ggplot(your_data, aes(x = as.factor(X1_date), y = X7_leaf_count,
fill = as.factor(phosphorous_p1.p4))) +
geom_boxplot(position = position_dodge(0.8)) +
labs(x = "Week", y = "Leaf number", fill = "Fertilizer") +
theme_minimal()
ggplot(summary_data, aes(x = as.factor(X1_date), y = X7_leaf_count,
fill = as.factor(phosphorous_p1.p4))) +
geom_boxplot(position = position_dodge(0.8)) +
labs(x = "Week", y = "Leaf number", fill = "Fertilizer") +
theme_minimal()
View(summary_data)
ggplot(data_pheno_full, aes(x = as.factor(X1_date), y = X7_leaf_count,
fill = as.factor(phosphorous_p1.p4))) +
geom_boxplot(position = position_dodge(0.8)) +
labs(x = "Week", y = "Leaf number", fill = "Fertilizer") +
theme_minimal()
View(summary_data)
ggplot(data_pheno_full, aes(x = as.factor(X1_date), y = mean_leaf,
fill = as.factor(phosphorous_p1.p4))) +
geom_boxplot(position = position_dodge(0.8)) +
labs(x = "Week", y = "Leaf number", fill = "Fertilizer") +
theme_minimal()
ggplot(summary_data, aes(x = as.factor(X1_date), y = mean_leaf,
fill = as.factor(phosphorous_p1.p4))) +
geom_boxplot(position = position_dodge(0.8)) +
labs(x = "Week", y = "Leaf number", fill = "Fertilizer") +
theme_minimal()
View(summary_data)
ggplot(your_data, aes(x = as.factor(X1_date), y = X7_leaf_count, fill = as.factor(phosphorous_p1.p4))) +
geom_boxplot(position = position_dodge(0.8)) +
labs(x = "Week", y = "Leaf number", fill = "Fertilizer") +
theme_minimal()
source("~/git/2025_g34p/scripts/phenology.R", echo = TRUE)
unique(data_pheno_full$X1_date)
## merging dates 08/14 & 08/16 together
data_pheno_full_weeks <- data_pheno_full %>%
mutate(week_grouped = case_when(
X1_date %in% c ("14/08/2025", "16/08/2025") ~ "08/14â€“08/16",
TRUE ~ as.character(X1_date)
))
View(data_pheno_full_weeks)
ggplot(data_pheno_full_weeks, aes(x = as.factor(X1_date),
y = X7_leaf_count,
fill = as.factor(phosphorous_p1.p4))) +
geom_boxplot(position = position_dodge(0.8)) +
labs(x = "Week", y = "Leaf number", fill = "Fertilizer") +
theme_minimal()
ggplot(data_pheno_full_weeks, aes(x = as.factor(X1_date),
y = X7_leaf_count,
fill = as.factor(phosphorous_p1.p4))) +
geom_boxplot(position = position_dodge(0.8)) +
labs(x = "Week", y = "Leaf number", fill = "Fertilizer") +
theme_minimal()
## adding weeks
data_pheno_full_weeks <- data_pheno_full %>%
mutate(week = case_when(
X1_date %in% c("14/08/2025", "16/08/2025") ~ "week 1",
X1_date %in% c("21/08/2025") ~ "week 2",
X1_date %in% c("21/08/2025") ~ "week 3",
TRUE ~ "other"   # catch-all for any date not assigned
))
View(data_pheno_full_weeks)
ggplot(data_pheno_full_weeks, aes(x = as.factor(week),
y = X7_leaf_count,
fill = as.factor(phosphorous_p1.p4))) +
geom_boxplot(position = position_dodge(0.8)) +
labs(x = "Week", y = "Leaf number", fill = "Fertilizer") +
theme_minimal()
## adding weeks
data_pheno_full_weeks <- data_pheno_full %>%
mutate(week = case_when(
X1_date %in% c("14/08/2025", "16/08/2025") ~ "week 1",
X1_date %in% c("21/08/2025") ~ "week 2",
X1_date %in% c("28/08/2025") ~ "week 3",
TRUE ~ "other"
))
ggplot(data_pheno_full_weeks, aes(x = as.factor(week),
y = X7_leaf_count,
fill = as.factor(phosphorous_p1.p4))) +
geom_boxplot(position = position_dodge(0.8)) +
labs(x = "Week", y = "Leaf number", fill = "Fertilizer") +
theme_minimal()
data_pheno_full_weeks_filtered <- data_pheno_full_weeks %>%
filter(week %in% c("week 1", "week 2", "week 3"),
phosphorous_p1.p4 %in% c("p1", "p2"))
## plotting
ggplot(data_pheno_full_weeks_filtered, aes(x = as.factor(week),
y = X7_leaf_count,
fill = as.factor(phosphorous_p1.p4))) +
geom_boxplot(position = position_dodge(0.8)) +
theme_minimal()
## filtering data we want to focus on
data_pheno_full_weeks_filtered <- data_pheno_full_weeks %>%
filter(week %in% c("week 1", "week 2", "week 3"),
phosphorous_p1.p4 %in% c("p1", "p4"))
## plotting
ggplot(data_pheno_full_weeks_filtered, aes(x = as.factor(week),
y = X7_leaf_count,
fill = as.factor(phosphorous_p1.p4))) +
geom_boxplot(position = position_dodge(0.8)) +
theme_minimal()
## plotting
ggplot(data_pheno_full_weeks_filtered, aes(x = as.factor(week),
y = X7_leaf_count,
fill = as.factor(phosphorous_p1.p4))) +
geom_boxplot(position = position_dodge(0.8)) +
facet_grid( ~shade_00s_70s) +
theme_minimal()
## plotting
ggplot(data_pheno_full_weeks_filtered, aes(x = as.factor(week),
y = X7_leaf_count,
fill = as.factor(phosphorous_p1.p4))) +
geom_boxplot(position = position_dodge(0.8)) +
facet_grid( ~ shade_00s_70s) +
theme_minimal()
## plotting
ggplot(data_pheno_full_weeks_filtered, aes(x = as.factor(week),
y = X7_leaf_count,
fill = as.factor(phosphorous_p1.p4))) +
geom_boxplot(position = position_dodge(0.8)) +
facet_wrap( ~ shade_00s_70s) +
theme_minimal()
## plotting
ggplot(data_pheno_full_weeks_filtered, aes(x = as.factor(week),
y = X7_leaf_count,
fill = as.factor(phosphorous_p1.p4))) +
geom_boxplot() +
facet_wrap( ~ shade_00s_70s) +
theme_minimal()
View(data_pheno_full_weeks_filtered)
## plotting
ggplot(data_pheno_full_weeks_filtered, aes(x = as.factor(week),
y = X7_leaf_count,
fill = as.factor(phosphorous_p1.p4))) +
geom_boxplot() +
facet_wrap( ~ shade_00s_70s)
ggplot(data_pheno_full_weeks_filtered, aes(x = as.factor(week),
y = X8_height_cm,
fill = as.factor(phosphorous_p1.p4))) +
geom_boxplot() +
facet_wrap( ~ shade_00s_70s)
ggplot(data_pheno_full_weeks_filtered, aes(x = as.factor(week),
y = X8_height_cm,
fill = as.factor(phosphorous_p1.p4))) +
geom_boxplot() +
facet_wrap( ~ shade_00s_70s)
## plotting c3 vs. c4
ggplot(data_pheno_full_weeks_filtered, aes(x = as.factor(week),
y = X7_leaf_count,
fill = as.factor(phosphorous_p1.p4))) +
geom_boxplot() +
facet_wrap( ~ c3_c4)
ggplot(data_pheno_full_weeks_filtered, aes(x = as.factor(week),
y = X8_height_cm,
fill = as.factor(phosphorous_p1.p4))) +
geom_boxplot() +
facet_wrap( ~ c3_c4)
## species plant height
ggplot(data_pheno_full_weeks_filtered, aes(x = as.factor(week),
y = X8_height_cm,
fill = as.factor(phosphorous_p1.p4))) +
geom_boxplot() +
facet_wrap( ~ usda_code)
## species plant height
ggplot(data_pheno_full_weeks_filtered, aes(x = as.factor(week),
y = X8_height_cm,
fill = as.factor(phosphorous_p1.p4))) +
geom_boxplot() +
facet_wrap( ~ usda_code + c3_c4)
## species plant height
ggplot(data_pheno_full_weeks_filtered, aes(x = as.factor(week),
y = X8_height_cm,
fill = as.factor(phosphorous_p1.p4))) +
geom_boxplot() +
facet_grid( ~ usda_code + c3_c4)
## species plant height
ggplot(data_pheno_full_weeks_filtered, aes(x = as.factor(week),
y = X8_height_cm,
fill = as.factor(phosphorous_p1.p4))) +
geom_boxplot() +
facet_wrap( ~ usda_code + c3_c4)
## species plant height
ggplot(data_pheno_full_weeks_filtered, aes(x = as.factor(week),
y = X8_height_cm,
fill = as.factor(phosphorous_p1.p4))) +
geom_boxplot() +
facet_wrap( ~ usda_code)
## species plant height
ggplot(data_pheno_full_weeks_filtered, aes(x = as.factor(week),
y = X8_height_cm,
fill = as.factor(phosphorous_p1.p4))) +
geom_boxplot() +
facet_wrap( ~ c3_c4 + usda_code)
## species plant height
ggplot(data_pheno_full_weeks_filtered, aes(x = as.factor(week),
y = X7_leaf_count,
fill = as.factor(phosphorous_p1.p4))) +
geom_boxplot() +
facet_wrap( ~ c3_c4 + usda_code)
## species plant height
ggplot(data_pheno_full_weeks_filtered, aes(x = as.factor(week),
y = X7_leaf_count,
fill = as.factor(phosphorous_p1.p4))) +
geom_boxplot() +
facet_wrap( ~ usda_code)
c3_c4 +
## species plant height
ggplot(data_pheno_full_weeks_filtered, aes(x = as.factor(week),
y = X7_leaf_count,
fill = as.factor(phosphorous_p1.p4))) +
geom_boxplot() +
facet_wrap( ~ c3_c4 + usda_code))
## species plant height
ggplot(data_pheno_full_weeks_filtered, aes(x = as.factor(week),
y = X7_leaf_count,
fill = as.factor(phosphorous_p1.p4))) +
geom_boxplot() +
facet_wrap( ~ c3_c4 + usda_code)
## species plant height
ggplot(data_pheno_full_weeks_filtered,
aes(x = as.factor(week),
y = X7_leaf_count,
fill = as.factor(phosphorous_p1.p4))) +
geom_boxplot() +
facet_wrap( ~ c3_c4 + usda_code)
library(tidyverse)
library(ggplot2)
library(dplyr)
library(stringr)
## species plant height
ggplot(data_pheno_full_weeks_filtered,
aes(x = as.factor(week),
y = X7_leaf_count,
fill = as.factor(phosphorous_p1.p4))) +
geom_boxplot() +
facet_wrap( ~ c3_c4 + usda_code)
